{"version":3,"sources":["components/Uploader.js","views/Home.js"],"names":["Dragger","Upload","Result","styled","div","H1","h1","Image","img","Component","observer","useStores","ImageStore","UserStore","ref1","useRef","ref2","store","useLocalStore","width","setWidth","height","setHeight","serverFile","attributes","url","widthStr","heightStr","props","showUploadList","beforeUpload","file","setFile","setFilename","name","currentUser","message","warning","window","test","type","size","error","upload","then","console","log","catch","tip","spinning","isUpoading","className","InboxOutlined","target","href","filename","src","ref","onChange","current","value","placeholder","fullStr","Home","username","Uploader"],"mappings":"oOAOQA,EAAYC,IAAZD,QAGFE,EAASC,IAAOC,IAAV,+FAKNC,EAAKF,IAAOG,GAAV,sEAIFC,EAAQJ,IAAOK,IAAV,iDAiHIC,EA3GGC,aAAS,WAAO,IAAD,EACKC,cAA1BC,EADqB,EACrBA,WAAYC,EADS,EACTA,UACdC,EAAOC,mBACPC,EAAOD,mBAEPE,EAAQC,aAAc,iBAAO,CAC/BC,MAAO,KACPC,SAF+B,SAEtBD,GACLF,EAAME,MAAQA,GAElB,eACI,OAAOF,EAAME,MAAN,aAAkBF,EAAME,OAAQ,IAE3CE,OAAQ,KACRC,UAT+B,SASrBD,GACNJ,EAAMI,OAASA,GAEnB,gBACI,OAAOJ,EAAMI,OAAN,aAAmBJ,EAAMI,QAAS,IAE7C,cAEI,OAAOT,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,IAAM,gBAAkBR,EAAMS,SAAWT,EAAMU,eAexGC,EAAQ,CACVC,gBAAgB,EAChBC,aAAc,SAAAC,GAGV,OAFAnB,EAAWoB,QAAQD,GACnBnB,EAAWqB,YAAYF,EAAKG,MACC,OAA1BrB,EAAUsB,aAETC,IAAQC,QAAQ,qDACT,IAEZC,OAAOP,KAAKA,EACN,wCAAwCQ,KAAKR,EAAKS,MAInDT,EAAKU,KAAO,SACZL,IAAQM,MAAM,+BACP,IAEX9B,EAAW+B,SACNC,MAAK,SAACrB,GACHsB,QAAQC,IAAI,4BACZD,QAAQC,IAAIvB,MACbwB,OAAM,WACTF,QAAQC,IAAI,gCAET,IAdHV,IAAQM,MAAM,0EACP,MAiBnB,OACI,gCACI,cAAC,IAAD,CAAMM,IAAI,qBAAMC,SAAUrC,EAAWsC,WAArC,SACA,eAAClD,EAAD,2BAAa4B,GAAb,cACI,mBAAGuB,UAAU,uBAAb,SACI,cAACC,EAAA,EAAD,MAEJ,mBAAGD,UAAU,kBAAb,kGACA,mBAAGA,UAAU,kBAAb,wIAOAvC,EAAWW,WAAa,eAACrB,EAAD,WACpB,cAACG,EAAD,uCACA,+BACI,0DACA,6BAAI,mBAAGgD,OAAO,SAASC,KAAM1C,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,IAAzE,SAAgFb,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,QACpI,oDACA,6BAAKb,EAAW2C,WAChB,0DACA,6BACI,cAAChD,EAAD,CAAOiD,IAAK5C,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,QAEhE,0DACA,+BACI,uBAAOgC,IAAK3C,EAAM4C,SApElB,WACpBb,QAAQC,IAAI,sBACZD,QAAQC,IAAIhC,EAAK6C,QAAQC,OACzB3C,EAAMG,SAASN,EAAK6C,QAAQC,QAiEqCC,YAAY,qDACzD,uBAAOJ,IAAKzC,EAAM0C,SA/DjB,WACrBzC,EAAMK,UAAUN,EAAK2C,QAAQC,QA8DqCC,YAAY,wDAE9D,6BACI,mBAAIR,OAAO,SAASC,KAAMrC,EAAM6C,QAAhC,SAA0C7C,EAAM6C,kBAGhD,WC1HtBC,EAAOrD,aAAS,WAAO,IACjBG,EAAcF,cAAdE,UAIR,OACI,qCAEQA,EAAUsB,YAAc,8CACbtB,EAAUsB,YAAYX,WAAWwC,YACvC,sEAMT,cAACC,EAAD,UAKGF","file":"static/js/9.1c939554.chunk.js","sourcesContent":["import React, { useRef } from 'react';\r\nimport { useStores } from '../stores';\r\nimport { observer, useLocalStore } from 'mobx-react';\r\nimport { Upload, message, Spin } from 'antd';\r\nimport { InboxOutlined } from '@ant-design/icons';\r\nimport styled from 'styled-components';\r\n\r\nconst { Dragger } = Upload;\r\n\r\n\r\nconst Result = styled.div`\r\n  margin-top: 30px;\r\n  border: 1px dashed #ccc;\r\n  padding: 20px;\r\n`;\r\nconst H1 = styled.h1`\r\n  margin: 20px 0;\r\n  text-align: center;\r\n`;\r\nconst Image = styled.img`\r\n  max-width: 300px;\r\n`;\r\n\r\n\r\n\r\nconst Component = observer(() => {\r\n    const { ImageStore, UserStore } = useStores();\r\n    const ref1 = useRef();\r\n    const ref2 = useRef();\r\n\r\n    const store = useLocalStore(() => ({\r\n        width: null,\r\n        setWidth(width) {\r\n            store.width = width;\r\n        },\r\n        get widthStr() {\r\n            return store.width?`/w/${store.width}`:'';\r\n        },\r\n        height: null,\r\n        setHeight(height) {\r\n            store.height = height;\r\n        },\r\n        get heightStr() {\r\n            return store.height?`/h/${store.height}`:'';\r\n        },\r\n        get fullStr() {\r\n            //?imageView2/0/w/800/h/400)\r\n            return ImageStore.serverFile.attributes.url.attributes.url + '?imageView2/0' + store.widthStr + store.heightStr\r\n        }\r\n\r\n    }));\r\n\r\n    const bindWidthChange = () => {\r\n        console.log('bindWidthChange...')\r\n        console.log(ref1.current.value)\r\n        store.setWidth(ref1.current.value);\r\n    };\r\n\r\n    const bindHeightChange = () => {\r\n        store.setHeight(ref2.current.value);\r\n    };\r\n\r\n    const props = {\r\n        showUploadList: false,\r\n        beforeUpload: file => {\r\n            ImageStore.setFile(file);\r\n            ImageStore.setFilename(file.name);\r\n            if(UserStore.currentUser === null) {\r\n                //判断用户是否处于登录状态\r\n                message.warning('请先登录再上传！');\r\n                return false;\r\n            }\r\n           window.file=file\r\n            if (!/(svg$)|(png$)|(jpg$)|(jpeg$)|(gif$)/ig.test(file.type)) {\r\n                message.error('只能上传png/svg/jpg/gif格式的图片');\r\n                return false;\r\n            }\r\n            if (file.size > 1024 * 1024) {\r\n                message.error('图片最大1M');\r\n                return false;\r\n            }\r\n            ImageStore.upload()\r\n                .then((serverFile) => {\r\n                    console.log('上传成功')\r\n                    console.log(serverFile);\r\n                }).catch(() => {\r\n                console.log('上传失败')\r\n            });\r\n            return false;\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            <Spin tip=\"上传中\" spinning={ImageStore.isUpoading}>\r\n            <Dragger {...props}>\r\n                <p className=\"ant-upload-drag-icon\">\r\n                    <InboxOutlined />\r\n                </p>\r\n                <p className=\"ant-upload-text\">单击或拖动文件到该区域以上传</p>\r\n                <p className=\"ant-upload-hint\">\r\n                    仅支持 .png / .jpg / .jpeg / .gif / .svg 格式的图片，图片最大 1M\r\n                </p>\r\n            </Dragger>\r\n            </Spin>\r\n\r\n            {\r\n                ImageStore.serverFile ? <Result>\r\n                    <H1>上传结果</H1>\r\n                    <dl>\r\n                        <dt>线上地址</dt>\r\n                        <dd><a target=\"_blank\" href={ImageStore.serverFile.attributes.url.attributes.url}>{ ImageStore.serverFile.attributes.url.attributes.url}</a></dd>\r\n                        <dt>文件名</dt>\r\n                        <dd>{ImageStore.filename}</dd>\r\n                        <dt>图片预览</dt>\r\n                        <dd>\r\n                            <Image src={ImageStore.serverFile.attributes.url.attributes.url}/>\r\n                        </dd>\r\n                        <dt>更多尺寸</dt>\r\n                        <dd>\r\n                            <input ref={ref1} onChange={bindWidthChange} placeholder=\"最大宽度（可选）\"/>\r\n                            <input ref={ref2} onChange={bindHeightChange} placeholder=\"最大高度（可选）\"/>\r\n                        </dd>\r\n                        <dd>\r\n                            <a  target=\"_blank\" href={store.fullStr}>{store.fullStr}</a>\r\n                        </dd>\r\n                    </dl>\r\n                </Result> : null\r\n            }\r\n        </div>\r\n    );\r\n});\r\nexport default Component;","import React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { useStores } from '../stores';\r\nimport Uploader from '../components/Uploader';\r\n\r\nconst Home = observer(() => {\r\n    const { UserStore } = useStores();\r\n\r\n    const User = () => <div>Hello {UserStore.currentUser.attribures.username} </div>\r\n\r\n    return (\r\n        <>\r\n            {\r\n                UserStore.currentUser ? <>\r\n                    Hello {UserStore.currentUser.attributes.username}\r\n                </> :<>\r\n                    用户未登录\r\n                </>\r\n\r\n            }\r\n\r\n            <Uploader />\r\n        </>\r\n    );\r\n});\r\n\r\nexport default Home;"],"sourceRoot":""}